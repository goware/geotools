package gmaps

import (
	"encoding/json"
	"errors"
	"fmt"

	"golang.org/x/net/context"
	"googlemaps.github.io/maps"
)

var (
	errUnknownMockResource = errors.New(`Unknown mock resource.`)
)

type mockApiClient struct {
}

func newMockMapsClient(_ string) (MapsApiClient, error) {
	return &mockApiClient{}, nil
}

func (m *mockApiClient) Details(_ context.Context, q string) (*maps.PlaceDetailsResult, error) {
	switch q {
	case `ChIJL6wn6oAOZ0gRoHExl6nHAAo`:
		r := func() (r *maps.PlaceDetailsResult) {
			if err := json.Unmarshal([]byte(`{"address_components":[{"long_name":"Dublin","short_name":"Dublin","types":["locality","political"]},{"long_name":"Dublin City","short_name":"Dublin City","types":["administrative_area_level_2","political"]},{"long_name":"Dublin","short_name":"Dublin","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"Dublin, Ireland","formatted_phone_number":"","international_phone_number":"","geometry":{"location":{"lat":53.3498053,"lng":-6.2603097},"location_type":"","viewport":{"northeast":{"lat":53.42521010000001,"lng":-6.0439235},"southwest":{"lat":53.22343009999999,"lng":-6.4474846}},"types":null},"name":"Dublin","icon":"https://maps.gstatic.com/mapfiles/place_api/icons/geocode-71.png","place_id":"ChIJL6wn6oAOZ0gRoHExl6nHAAo","scope":"GOOGLE","rating":0,"types":["locality","political"],"opening_hours":null,"photos":null,"alt_ids":null,"price_level":0,"vicinity":"Dublin","permanently_closed":false,"reviews":null,"utc_offset":0,"website":"","url":"https://maps.google.com/?q=Dublin,+Ireland\u0026ftid=0x48670e80ea27ac2f:0xa00c7a9973171a0","HTMLAttributions":[]}`), &r); err != nil {
				panic(err.Error())
			}
			return
		}()
		return r, nil
	}
	return nil, errUnknownMockResource
}

func (m *mockApiClient) TextSearch(_ context.Context, q string) ([]maps.PlacesSearchResult, error) {
	switch q {
	case `Toronto`:
		r := func() (r []maps.PlacesSearchResult) {
			if err := json.Unmarshal([]byte(`[{"formatted_address":"Toronto, ON, Canada","geometry":{"location":{"lat":43.653226,"lng":-79.3831843},"location_type":"","viewport":{"northeast":{"lat":43.8554579,"lng":-79.116897},"southwest":{"lat":43.5810245,"lng":-79.639219}},"types":null},"name":"Toronto","icon":"https://maps.gstatic.com/mapfiles/place_api/icons/geocode-71.png","place_id":"ChIJpTvG15DL1IkRd8S0KlBVNTI","scope":"","rating":0,"types":["locality","political"],"opening_hours":null,"photos":null,"alt_ids":null,"price_level":0,"vicinity":""}]`), &r); err != nil {
				panic(err.Error())
			}
			return
		}()
		return r, nil
	}
	return nil, errUnknownMockResource
}

func (m *mockApiClient) Autocomplete(_ context.Context, q string) ([]maps.AutocompletePrediction, error) {
	switch q {
	case `dublin`:
		r := func() (r []maps.AutocompletePrediction) {
			if err := json.Unmarshal([]byte(`[{"description":"Dublin, Ireland","place_id":"ChIJL6wn6oAOZ0gRoHExl6nHAAo","types":["locality","political","geocode"],"matched_substrings":[{"length":6,"offset":0}],"terms":[{"value":"Dublin","offset":0},{"value":"Ireland","offset":8}]},{"description":"Dublin Airport, Dublin, Ireland","place_id":"ChIJLxmTab4RZ0gRVfMlt7UbElU","types":["establishment"],"matched_substrings":[{"length":6,"offset":0}],"terms":[{"value":"Dublin Airport","offset":0},{"value":"Dublin","offset":16},{"value":"Ireland","offset":24}]},{"description":"Dublin, CA, United States","place_id":"ChIJMSKJ1lzmj4ARV0D2joR8Mjs","types":["locality","political","geocode"],"matched_substrings":[{"length":6,"offset":0}],"terms":[{"value":"Dublin","offset":0},{"value":"CA","offset":8},{"value":"United States","offset":12}]},{"description":"Dublin, OH, United States","place_id":"ChIJH6FQ1MTsOIgRKJBoFWgXwgA","types":["locality","political","geocode"],"matched_substrings":[{"length":6,"offset":0}],"terms":[{"value":"Dublin","offset":0},{"value":"OH","offset":8},{"value":"United States","offset":12}]},{"description":"Dublin, GA, United States","place_id":"ChIJBwNQPw4g8YgR5QLzgZrnqYI","types":["locality","political","geocode"],"matched_substrings":[{"length":6,"offset":0}],"terms":[{"value":"Dublin","offset":0},{"value":"GA","offset":8},{"value":"United States","offset":12}]}]`), &r); err != nil {
				panic(err.Error())
			}
			return
		}()
		return r, nil
	}
	return nil, errUnknownMockResource
}

func (m *mockApiClient) ReverseGeocode(_ context.Context, lat float64, lng float64) ([]maps.GeocodingResult, error) {
	switch fmt.Sprintf(`%v/%v`, lat, lng) {
	case `53.339897/-6.538458899999999`:
		r := func() (r []maps.GeocodingResult) {
			if err := json.Unmarshal([]byte(`[{"address_components":[{"long_name":"3","short_name":"3","types":["street_number"]},{"long_name":"Main Street","short_name":"R405","types":["route"]},{"long_name":"Celbridge","short_name":"Celbridge","types":["locality","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_2","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"3 Main St, Celbridge, Co. Kildare, Ireland","geometry":{"location":{"lat":53.3399016,"lng":-6.5384725},"location_type":"RANGE_INTERPOLATED","viewport":{"northeast":{"lat":53.3408753302915,"lng":-6.537411269708498},"southwest":{"lat":53.3381773697085,"lng":-6.540109230291502}},"types":null},"types":["street_address"],"place_id":"EiozIE1haW4gU3QsIENlbGJyaWRnZSwgQ28uIEtpbGRhcmUsIElyZWxhbmQ"},{"address_components":[{"long_name":"Saint Patrick's Church","short_name":"Saint Patrick's Church","types":["premise"]},{"long_name":"Main Street","short_name":"Main St","types":["route"]},{"long_name":"Celbridge","short_name":"Celbridge","types":["locality","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_2","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"Saint Patrick's Church, Main St, Celbridge, Co. Kildare, Ireland","geometry":{"location":{"lat":53.3398516,"lng":-6.5395346},"location_type":"ROOFTOP","viewport":{"northeast":{"lat":53.3412005802915,"lng":-6.538185619708497},"southwest":{"lat":53.3385026197085,"lng":-6.540883580291502}},"types":null},"types":["premise"],"place_id":"ChIJgfNuEwdxZ0gRMIbiOb1Sa2Q"},{"address_components":[{"long_name":"Celbridge Medical Centre","short_name":"Celbridge Medical Centre","types":["premise"]},{"long_name":"Main Street","short_name":"Main St","types":["route"]},{"long_name":"Celbridge","short_name":"Celbridge","types":["locality","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_2","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"Celbridge Medical Centre, Main St, Celbridge, Co. Kildare, Ireland","geometry":{"location":{"lat":53.3392717,"lng":-6.538785900000001},"location_type":"ROOFTOP","viewport":{"northeast":{"lat":53.3406206802915,"lng":-6.537436919708499},"southwest":{"lat":53.3379227197085,"lng":-6.540134880291503}},"types":null},"types":["premise"],"place_id":"ChIJdROcBQdxZ0gRg-ng1he8Qsw"},{"address_components":[{"long_name":"Main Street","short_name":"Main St","types":["route"]},{"long_name":"Celbridge","short_name":"Celbridge","types":["locality","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_2","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"Main St, Celbridge, Co. Kildare, Ireland","geometry":{"location":{"lat":53.3392908,"lng":-6.5392404},"location_type":"ROOFTOP","viewport":{"northeast":{"lat":53.3406397802915,"lng":-6.537891419708497},"southwest":{"lat":53.3379418197085,"lng":-6.540589380291502}},"types":null},"types":["premise"],"place_id":"ChIJbR6BGgdxZ0gRDffbYoZnKWU"},{"address_components":[{"long_name":"Saint Brigid's Convent","short_name":"Saint Brigid's Convent","types":["premise"]},{"long_name":"Main Street","short_name":"Main St","types":["route"]},{"long_name":"Celbridge","short_name":"Celbridge","types":["locality","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_2","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"Saint Brigid's Convent, Main St, Celbridge, Co. Kildare, Ireland","geometry":{"location":{"lat":53.3396634,"lng":-6.539865799999999},"location_type":"ROOFTOP","viewport":{"northeast":{"lat":53.3410123802915,"lng":-6.538516819708497},"southwest":{"lat":53.3383144197085,"lng":-6.541214780291502}},"types":null},"types":["premise"],"place_id":"ChIJy33EFQdxZ0gRkSfT07swOSg"},{"address_components":[{"long_name":"Flat 17A","short_name":"Flat 17A","types":["premise"]},{"long_name":"An Phríomh Shraid","short_name":"An Phríomh Shraid","types":["route"]},{"long_name":"Cill Droichid","short_name":"Cill Droichid","types":["locality","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_2","political"]},{"long_name":"Cill Dara","short_name":"Cill Dara","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"Flat 17A, Flat 17, An Phríomh Shraid, Cill Droichid, Co. Cill Dara, Ireland","geometry":{"location":{"lat":53.33901940000001,"lng":-6.538994799999999},"location_type":"ROOFTOP","viewport":{"northeast":{"lat":53.34036838029151,"lng":-6.537645819708497},"southwest":{"lat":53.33767041970851,"lng":-6.540343780291502}},"types":null},"types":["premise"],"place_id":"ChIJgRtSGwdxZ0gRPtbcAnjan3E"},{"address_components":[{"long_name":"Saint Anne's","short_name":"Saint Anne's","types":["premise"]},{"long_name":"Main Street","short_name":"Main St","types":["route"]},{"long_name":"Celbridge","short_name":"Celbridge","types":["locality","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_2","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"Saint Anne's, Main St, Celbridge, Co. Kildare, Ireland","geometry":{"location":{"lat":53.3390575,"lng":-6.5394122},"location_type":"ROOFTOP","viewport":{"northeast":{"lat":53.3404064802915,"lng":-6.538063219708498},"southwest":{"lat":53.3377085197085,"lng":-6.540761180291502}},"types":null},"types":["premise"],"place_id":"ChIJIxXfGwdxZ0gRIspFJ-oEzNQ"},{"address_components":[{"long_name":"Property House","short_name":"Property House","types":["premise"]},{"long_name":"Apartment 4","short_name":"Apartment 4","types":["subpremise"]},{"long_name":"Main Street","short_name":"Main St","types":["route"]},{"long_name":"Celbridge","short_name":"Celbridge","types":["locality","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_2","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"Apartment 4, Property House, Main St, Celbridge, Co. Kildare, Ireland","geometry":{"location":{"lat":53.3388885,"lng":-6.539567799999999},"location_type":"ROOFTOP","viewport":{"northeast":{"lat":53.3402374802915,"lng":-6.538218819708497},"southwest":{"lat":53.3375395197085,"lng":-6.540916780291502}},"types":null},"types":["premise"],"place_id":"ChIJTe7bHgdxZ0gRAgaqKu5wWLI"},{"address_components":[{"long_name":"The Green Door","short_name":"The Green Door","types":["premise"]},{"long_name":"Main Street","short_name":"Main St","types":["route"]},{"long_name":"Celbridge","short_name":"Celbridge","types":["locality","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_2","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"The Green Door, Main St, Celbridge, Co. Kildare, Ireland","geometry":{"location":{"lat":53.33873029999999,"lng":-6.5392315},"location_type":"ROOFTOP","viewport":{"northeast":{"lat":53.34007928029149,"lng":-6.537882519708497},"southwest":{"lat":53.33738131970849,"lng":-6.540580480291502}},"types":null},"types":["premise"],"place_id":"ChIJ3aDAHQdxZ0gRE5DyVmLrMoI"},{"address_components":[{"long_name":"Celbridge, Main St Celbridge","short_name":"Celbridge, Main St Celbridge","types":["point_of_interest","establishment"]},{"long_name":"Celbridge","short_name":"Celbridge","types":["locality","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_2","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"Celbridge, Main St Celbridge, Celbridge, Co. Kildare, Ireland","geometry":{"location":{"lat":53.33915409999999,"lng":-6.539159100000001},"location_type":"APPROXIMATE","viewport":{"northeast":{"lat":53.34050308029149,"lng":-6.537810119708499},"southwest":{"lat":53.3378051197085,"lng":-6.540508080291503}},"types":null},"types":["bus_station","transit_station","point_of_interest","establishment"],"place_id":"ChIJmxfjGgdxZ0gR1p6poLvatQg"},{"address_components":[{"long_name":"Donaghcumper","short_name":"Donaghcumper","types":["neighborhood","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_2","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"Donaghcumper, Co. Kildare, Ireland","geometry":{"location":{"lat":53.3385628,"lng":-6.532259},"location_type":"APPROXIMATE","viewport":{"northeast":{"lat":53.345163,"lng":-6.5225674},"southwest":{"lat":53.3341885,"lng":-6.542429299999999}},"types":null},"types":["neighborhood","political"],"place_id":"ChIJOS6bnwlxZ0gR4su9GajHACY"},{"address_components":[{"long_name":"Celbridge","short_name":"Celbridge","types":["locality","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_2","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"Celbridge, Co. Kildare, Ireland","geometry":{"location":{"lat":53.339897,"lng":-6.538458899999999},"location_type":"APPROXIMATE","viewport":{"northeast":{"lat":53.35711999999999,"lng":-6.5239699},"southwest":{"lat":53.32322,"lng":-6.56685}},"types":null},"types":["locality","political"],"place_id":"ChIJz_ON-A5xZ0gR0Owxl6nHAAo"},{"address_components":[{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_2","political"]},{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"Kildare, Co. Kildare, Ireland","geometry":{"location":{"lat":53.2120434,"lng":-6.819470799999999},"location_type":"APPROXIMATE","viewport":{"northeast":{"lat":53.4512374,"lng":-6.459963999999999},"southwest":{"lat":52.8575787,"lng":-7.168930500000001}},"types":null},"types":["administrative_area_level_2","political"],"place_id":"ChIJa3HKcbV_XUgRQHUqLqfHAAM"},{"address_components":[{"long_name":"Kildare","short_name":"Kildare","types":["administrative_area_level_1","political"]},{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"Co. Kildare, Ireland","geometry":{"location":{"lat":53.2137545,"lng":-6.8661128},"location_type":"APPROXIMATE","viewport":{"northeast":{"lat":53.4512374,"lng":-6.459963999999999},"southwest":{"lat":52.8575787,"lng":-7.168930500000001}},"types":null},"types":["administrative_area_level_1","political"],"place_id":"ChIJR3HKcbV_XUgR8AKA8azHABg"},{"address_components":[{"long_name":"Ireland","short_name":"IE","types":["country","political"]}],"formatted_address":"Ireland","geometry":{"location":{"lat":53.41291,"lng":-8.24389},"location_type":"APPROXIMATE","viewport":{"northeast":{"lat":55.4351345,"lng":-5.7203899},"southwest":{"lat":51.3089707,"lng":-10.66949}},"types":null},"types":["country","political"],"place_id":"ChIJ-ydAXOS6WUgRCPTbzjQSfM8"}]`), &r); err != nil {
				panic(err.Error())
			}
			return
		}()
		return r, nil
	}
	return nil, errUnknownMockResource
}
